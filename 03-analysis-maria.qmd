---
title: "Analysis"
---

Goals of this notebook: 

- What do these numbers show us about what kinds of crimes are being committed? How many are drug crimes?
- Who is being arrested?
- Who is doing the arresting?
- What kind of drugs? Is it fentanyl like Abbott says? Are most of the people getting arrested for human smuggling Black? What does the data show and why might that be? 
- Are a lot of people getting arrested in a specific backyard or area? 
- Are most of the people arrested U.S. citizens? **

## Loading up libraries 

```{r}
#| label: setup
#| message: false


library(tidyverse)
library(janitor)
library(dplyr)
```


## Importing clean combined data, VERSA and SPURS 

```{r}
ols_data <- read_rds("data-processed/02-combine.rds")

ols_data
```

## What do these numbers show us about what kinds of crimes are being committed? How many are drug crimes?


Let's look at the different charges under the charge category: 

```{r}
ols_data$charge |> unique()
```

I want to create different categories for all the charges in the dataset.    


```{r}
cat_ols <- ols_data |>
  mutate(
    charge_cat = case_when(
      str_detect(
        charge,
        "Drug|CS|Cs|Mari|DRUG|MARI|Marj|MARJ|Man|Subs|Stash|Chem"
      ) ~ "Drug",
      str_detect(
        charge,
        "Smugg|SMUGG|Trafficking|TRAFFICKING|Trans|Bringing In"
      ) ~ "Smuggling/Trafficking of Persons",
      str_detect(charge, "Firearm|FIREARM|gun|GUN|Amm|Arm|Weapon|WEAPON") ~ "Weapon",
      str_detect(charge, "Launder|LAUNDER") ~ "Money Laundering",
      str_detect(charge, "Trespass|TRESPASS") ~ "Trespassing",
      str_detect(charge, "Alien|ALIEN|Visa|VISA|IMMIGRATION|Immigration") ~ "Immigration Other",
      str_detect(charge, "Evad|EVAD|Flee|FLEE") ~ "Evasion/Fleeing",
      str_detect(charge, "Organized|Enterprise") ~ "Organized Crime",
      str_detect(charge, "Tamp|TAMP") ~ "Tampering",
      str_detect(charge, "Unauth") ~ "Unauthorized Use of Vehicle",
      str_detect(charge, "Warrant|WARRANT") ~ "Warrant",
      str_detect(charge, "Conspiracy|CONSPIRACY") ~ "Conspiracy"
    ),
    
    default. = NA
  )

cat_ols |>
  count(charge, charge_cat) 
  

```

CATEGORY KEY (11): 

- Drug = Any charge that relates to possession or manufacturing of drug, as well as any drug-related charges like stash house charges.    One problem is that there are some unclear  "drug/weapon" offenses.
- Weapon = Any charge relating to possession/use of unauthorized firearms or weapons. 
- Warrant/Conspiracy = general charges. 
- Smuggling/Trafficking of Persons = Human trafficking or smuggling charges. This category can also include charges for smuggling persons and firearms. 
- Trespassing = Includes all types of trespassing charges. 
- Immigration Other = Immigration status charges. 
- Evasion/Fleeing = Escaping authority charges. 
- Organized Crime
- Tampering = Charges related to tampering with evidence. 
- Unauthorized Use of Vehicle
- Money Laundering 


Let's count per category to determine how many of these are drug crimes: 


```{r}
cat_ols |>  
  group_by(charge_cat) |> 
  summarise(appearances = n()) |> 
  arrange(desc(appearances))
```
 
 Note: 
 - solo drug charges that aren't fentanyl 

 Data Takeaway:
 
 - At least 23,233 charges under Operation Lone Star are drug-related. 
 - Categories include money laundering, tampering with evidence and unauthorized use of vehicle have more charges than immigration related charges. 
 
 
## What kind of drugs? Is it fentanyl like Abbott says? 

Let's look at the drug charge category and break it down by type of drug. We used drug statute codes from state government (https://statutes.capitol.texas.gov/Docs/HS/htm/HS.481.htm) and the Drug Enforcement Agency (https://www.dea.gov/drug-information/drug-scheduling.) 


```{r}
drug_ols <- cat_ols |>
  group_by(charge) |>
  filter(charge_cat == "Drug") |>
  mutate(
    drug_type = case_when(
      str_detect(charge, "Mari|MARI|Marj|MARJ") ~ "Marijuana",
      str_detect(charge, "Fent|FENT|1-B") ~ "Fentanyl",
      str_detect(charge, "Cocaine|COCAINE") ~ "Cocaine",
      str_detect(charge, "Meth|METH") ~ "Crystal Meth",
      str_detect(charge, "1a|1-A|LSD")  ~ "LSD",
      str_detect(charge, "Heroin|HEROIN") ~ "Heroin"),
   
     default. = NA, 
    
    fentanyl = case_when(
      str_detect(charge, "Fent|FENT|1-B|Schedule Ii/") ~ "YES"),
    
    default. = NA, 
    
    marijuana = case_when(
      str_detect(charge, "Mari|MARI|Marj|MARJ|Drug Test|Schedule I/") ~ "YES"),
    
    default. = NA, 
    
    drug_weapon = case_when(
      str_detect(charge, "DRUG/WEAPON") ~ "YES"),
    
    default. = NA
  )
    
    
    
    
    
    
  
    drug_ols |>
    count(drug_type, fentanyl, marijuana, drug_weapon)

  
  

```

Originally, I tried categorizing the charges by type of drug, but this doesn't work out well because of the different codes used. So I decided to focus on any charges that could be related to fentanyl (as some are unclear) to answer our question. I also focused on marijuana charges, one of the more recurring drug offenses. Then I made a column called drug_weapon for all charges under the drug category that could also be weapons charges. 
 
NOTES: 
 
 - Poss Cs Pg = Possession of Controlled Substance in Penalty Group 
 - Fentanyl is group 1-B (any type of fentanyl)
 - Drug schedules can refer to drugs like other drugs (for example, fentanyl can be found in schedule II drugs)
 - 1-A LSD as well as any of its salts, isomers, and salts of isomers.
 - Under Sec. 481.133.  OFFENSE:  FALSIFICATION OF DRUG TEST RESULTS, can refer to failing an authorized marijuana drug test, so I noted that as "YES" under marijuana column. 

Let's count the amount of charges that can fall under fentanyl and marijuana: 

```{r}
drug_ols |>
  group_by(fentanyl, marijuana) |>
  summarise(appearnaces = n()) |>
  arrange(desc(appearnaces)) |>
  filter( fentanyl == "YES" | marijuana == "YES") 
```


 Data Takeaway: 
 
 - At least 1,571 charges in both OLS datasets are related to possession/manufacturing of fentanyl. This is lower than the amount of charges related to marijuana, which are at least 9,491. 
 - Overall, fentanyl charges identified in this analysis account for little over 6% of all drug charges, while marijuana charges account for little over 40% of the drug charges (from the total 23,233 drug charges identified). 
 
##Solo drug charges 
 
Now let's look at the individuals being charged for drug charges: 

```{r}
cat_ols |>
  filter(charge_cat == "Drug") |>
  count(charge_count) 
```


Data Takeaways: Most charges are solo charges. 

Now let's look at the solo charges and what drugs they are related too. 
 
```{r}
solo_drug_ols <- cat_ols |>
  group_by(charge, charge_count) |>
  filter(charge_cat == "Drug") |>
mutate(
fentanyl = case_when(
      str_detect(charge, "Fent|FENT|1-B|Schedule Ii/") ~ "YES"),
    

    marijuana = case_when(
      str_detect(charge, "Mari|MARI|Marj|MARJ|Drug Test|Schedule I/") ~ "YES"),

   
  
    default. = NA, 

) |>
  filter(charge_count == "1")

solo_drug_ols |>
count(charge, charge_count, fentanyl, marijuana)

```
 
 
 
```{r}
solo_drug_type <- 
  solo_drug_ols |>
  ungroup() |>
  mutate(drug_charge = case_when(
    str_detect(fentanyl, "YES") ~ "fentanyl",
    str_detect(marijuana, "YES") ~ "marijuana",
    .default = "other"
  )
)

solo_drug_type |>
  count(drug_charge)

```
 
   

 
Where are solo drug charges located? 
 
```{r}
solo_drug_ols |>
  group_by(arrest_county) |>
  summarise(appearances = n()) |>
  arrange(desc(appearances))
```
 
 Let's look at Ector, the 6th county with the most solo drug charges. Ector county is not near the border. 
 
```{r}
solo_drug_ols |>
  mutate(
    fentanyl = case_when(
      str_detect(charge, "Fent|FENT|1-B|Schedule Ii/") ~ "YES"),
    
    default. = NA, 
    
    marijuana = case_when(
      str_detect(charge, "Mari|MARI|Marj|MARJ|Drug Test|Schedule I/") ~ "YES"),


  ) |> 

```
 

## Are most of the people getting arrested for human smuggling Black? What does the data show and why might that be?

To answer this question, lets look at the smuggling/trafficking charges and look at the offenders by race. 


```{r}
smuggle_ols <- cat_ols |>
  group_by(person_race_abbr,charge_cat) |>
  summarise(appearances = n()) |> 
  arrange(desc(appearances)) |>
  filter(charge_cat == "Smuggling/Trafficking of Persons") |>
  select(!charge_cat)

smuggle_ols
```
Key: 
- B = Black 
- H = Hispanic (if race not given, only ethnicity)
- W = White 
- A = American Indian or Alaska Native 
- U & NA = Unknown 

Data Takeaways: 

- Most people arrested for smuggling/trafficking aren't Black. Although, 1,184 of those charged with smuggling/trafficking people under Opertion Lone Star are Black making up little over 10% of charges (from smuggling category total). 
- Of those charged, the most common ethnicity (without taking into consideration race) is Hispanic, with 8,178 charges. SPURS dataset does not differentiate between ethnicity and race which might affect the results of the data. 


NEXT STEPS?: 
- Look at B charges and then look at their location... does this line up with Houston? 


 
